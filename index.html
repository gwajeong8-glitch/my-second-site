<!DOCTYPE html>

<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Noblesse ë°ì´í„° í…Œì´ë¸” ì—ë””í„°</title>
    <!-- Tailwind CSS (Aesthetics and responsiveness) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- html2canvas for image download -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        /* CSS Variables */
        :root{
            /* ê¸°ë³¸ê°’ (í…Œì´ë¸” ê¸°ë³¸ ìŠ¤íƒ€ì¼ ìœ ì§€) */
            --table-header-bg: #2196F3;
            --table-header-text: #ffffff;
            --table-row-bg: #1B5E20; /* ë…¹ìƒ‰ í–‰ ë°°ê²½ */
            --table-row-text: #C8F7DC; /* ë°ì€ ë…¹ìƒ‰ í–‰ ê¸€ì */
            --table-border: rgba(255,255,255,0.15);
            
            /* ê³ ì • ìƒ‰ìƒ */
            --yellow-bg: #FFD700;
            --dark-text: #1A1A1A;
            --red-highlight: #FF0000; 
            
            --col-num-text-color: var(--red-highlight); 
        }

        /* ğŸ¨ Body ë° Global Styles */
        body {
            /* ğŸš€ ë°°ê²½ ì´ë¯¸ì§€ ìœ„ì¹˜ ì¡°ì • (200px ì•„ë˜ë¡œ) */
            /* âš ï¸ ì£¼: vip.png íŒŒì¼ì´ ì—†ìœ¼ë¯€ë¡œ, ê¸°ë³¸ ë°°ê²½ìƒ‰ìœ¼ë¡œ ëŒ€ì²´í•˜ê±°ë‚˜ placeholder ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ, ì›ë³¸ ìš”ì²­ì„ ë”°ë¦…ë‹ˆë‹¤. */
            background: url('https://placehold.co/1920x1080/000000/ffffff?text=Background+Image+Placeholder') no-repeat center 0px fixed; 
            background-size: cover; /* ë°˜ì‘í˜• ëŒ€ì‘ */
            margin: 0;
            padding: 0;
            font-family: 'Inter', Arial, sans-serif;
            color: white;
            /* overflow-x: hidden; */ /* xì¶• ìŠ¤í¬ë¡¤ì€ í—ˆìš©í•˜ì§€ ì•ŠìŒ */
        }
        .wrap {
            /* ë˜í¼ (ìº¡ì²˜ ëŒ€ìƒ ì˜ì—­) */
            width: min(100%, 1024px); /* ë°˜ì‘í˜• ëŒ€ì‘ */
            max-width: 1024px;
            height: 490px;
            margin: 20px auto 0 auto; 
            position: relative;
            overflow: hidden;
            background-color: transparent; 
        }

        /* ìƒë‹¨ íƒ­ */
        .top-sub-menu{
            position: absolute;
            top: 30px;
            left: 50%;
            transform: translateX(-50%); /* ì¤‘ì•™ ì •ë ¬ */
            display: flex;
            gap: 20px;
            z-index: 5;
            flex-wrap: wrap; /* ëª¨ë°”ì¼ ëŒ€ì‘ */
            justify-content: center;
        }
        .top-sub-menu .menu{
            background: rgba(160,160,160,0.3);
            padding: 8px 15px;
            border-radius: 5px;
            font-size: 14px;
        }

        /* ì™¼ìª½ ë©”ë‰´ */
        .left-menu{
            position: absolute;
            left: 50px;
            top: 100px;
            width: 115px;
            line-height: 16px;
            font-size: 13px;
            z-index: 5;
        }
        /* ëª¨ë°”ì¼ì—ì„œ ì™¼ìª½ ë©”ë‰´ ìˆ¨ê¹€ */
        @media (max-width: 1023px) {
            .left-menu {
                display: none;
            }
        }
        .left-item{
            padding: 1px 0;
            cursor: pointer;
            transition: 0.15s;
        }
        .left-item:hover {
            color: #FFDD66;
        }
        .left-item.active{
            color: #ffdd66;
            font-weight: 700;
            text-shadow: 0 0 6px #ffdd66;
        }

        /* ğŸ“Š í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .data-table{
            position: absolute;
            top: 80px;
            left: 175px; /* ì™¼ìª½ ë©”ë‰´ ê³µê°„ í™•ë³´ */
            width: 730px; 
            border-collapse: collapse;
            font-size: 8px;
            z-index: 4;
            overflow: hidden;
            box-shadow: 0 2px 0 rgba(0,0,0,0.35);
        }
        /* ëª¨ë°”ì¼ ëŒ€ì‘: í…Œì´ë¸” ì¤‘ì•™ ì •ë ¬ ë° í¬ê¸° ì¡°ì • */
        @media (max-width: 1023px) {
            .data-table {
                left: 50%;
                transform: translateX(-50%);
                width: 95%; /* ë·°í¬íŠ¸ ëŒ€ë¹„ 95% */
            }
        }

        /* í…Œì´ë¸” ì…€ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        .data-table td{
            background: var(--table-row-bg); 
            color: var(--table-row-text); 
            padding: 2px 2px; 
            min-height: 16px;
            text-align: center;
            border-bottom: 1px solid var(--table-border);
            border-right: 1px solid var(--table-border);
            white-space: nowrap;
            outline: none; 
            box-sizing: border-box; /* íŒ¨ë”©ì´ ë„ˆë¹„ì— í¬í•¨ë˜ë„ë¡ ì„¤ì • */
            user-select: none; /* ë“œë˜ê·¸ ë°©ì§€ */
        }

        /* ë§ˆì§€ë§‰ ì…€ì˜ ì˜¤ë¥¸ìª½ ê²½ê³„ì„  ì œê±° */
        .data-table tr td:last-child {
            border-right: none;
        }

        /* í™œì„± ì…€(td) ìŠ¤íƒ€ì¼: í´ë¦­ ì‹œ í…Œë‘ë¦¬ë¡œ ê°•ì¡° */
        /* JSì—ì„œ ìº¡ì²˜ ì „/í›„ì— .selected í´ë˜ìŠ¤ë¥¼ í† ê¸€í•˜ê¸° ë•Œë¬¸ì— ìº¡ì²˜ ì‹œ ë…¸ë€ìƒ‰ í…Œë‘ë¦¬ëŠ” ë‚˜íƒ€ë‚˜ì§€ ì•ŠìŠµë‹ˆë‹¤. */
        .data-table td.selected {
            outline: 2px solid #FFD700; 
            outline-offset: -2px;
            cursor: pointer;
        }

        /* í˜¸ë²„ ì‹œ ë°°ê²½ìƒ‰ ìˆ˜ì • (ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ì´ ì—†ëŠ” ê²½ìš°ì—ë§Œ ì ìš©) */
        .data-table tr:hover td:not([style*="background-color"]):not([data-bg-color]){
            background: #567d58; 
        }

        /* ìƒë‹¨ ê³µì§€ í†µí•© ì…€ */
        .data-table .top-notice-row td {
            background: var(--yellow-bg); 
            color: var(--dark-text); 
            text-align: left;
            padding: 1px 4px; 
            font-size: 8px;
            font-weight: 700;
            line-height: 1.2;
            border-bottom: 2px solid var(--table-border);
            white-space: normal; 
        }
        .data-table .top-notice-mark {
            color: var(--red-highlight); 
            font-weight: 900;
            margin-right: 2px;
        }

        /* ìƒë‹¨ ë°ì´í„° í—¤ë” */
        .data-table .top-data-header td {
            background: var(--table-header-bg); 
            color: var(--table-header-text); 
            font-weight: 700;
            height: 15px; 
            /* width: 20%; ì´ ìŠ¤íƒ€ì¼ì€ ë¦¬ì‚¬ì´ì§• ë°©í•´ ê°€ëŠ¥ì„±ì´ ìˆì–´ ì œê±°í•˜ê±°ë‚˜ ìµœì†Œí™”í•©ë‹ˆë‹¤. */
        }

        /* ìƒë‹¨ ë°ì´í„° í–‰ */
        .data-table .top-data-row td {
            height: 15px; 
        }
        .data-table .top-data-row td:nth-child(3),
        .data-table .top-data-row td:nth-child(4) {
            color: var(--col-num-text-color); 
            font-weight: 700;
        }

        /* ì¤‘ê°„ ì œëª©/ê³µì§€ ì…€ */
        .data-table .middle-notice-row td {
            background: var(--yellow-bg); 
            color: var(--dark-text); 
            text-align: left;
            padding: 4px 6px; 
            font-size: 8px;
            line-height: 1.3; 
            white-space: normal; 
            border-bottom: 2px solid var(--table-border);
        }

        /* í•˜ë‹¨ ë°ì´í„° í—¤ë” */
        .data-table .bottom-data-header td {
            background: var(--table-header-bg); 
            color: var(--table-header-text); 
            font-weight: 700;
            font-size: 14px;
            height: 10px; 
            padding-top: 0px; 
            padding-bottom: 0px; 
            line-height: 1; 
            /* width: 20%; */
        }
        .data-table .bottom-data-header {
            height: 10px; 
        }


        /* í•˜ë‹¨ ë°ì´í„° í–‰ */
        .data-table .bottom-data-row td {
            font-weight: 700;
            font-size: 14px;
            height: 10px; 
            padding-top: 0px; 
            padding-bottom: 0px; 
            line-height: 1; 
        }
        .data-table .bottom-data-row {
            height: 10px; 
        }
        .data-table .bottom-data-row .red-text {
            color: var(--col-num-text-color); 
        }

        /* --- ì„¤ì • íŒ¨ë„ ìŠ¤íƒ€ì¼ --- */
        .setting-panel{
            position: fixed;
            top: 10px;
            right: 10px;
            width: 250px;
            padding: 15px;
            border: 1px solid #333;
            border-radius: 8px;
            color: white;
            z-index: 100; 
            font-size: 12px;
            background: rgba(0, 0, 0, 0.7); 
            backdrop-filter: blur(5px);
            max-height: 95vh;
            overflow-y: auto;
        }
        /* ëª¨ë°”ì¼ ëŒ€ì‘: ì„¤ì • íŒ¨ë„ì„ í•˜ë‹¨ì— ë°°ì¹˜ */
        @media (max-width: 600px) {
            .setting-panel {
                top: auto;
                bottom: 0;
                right: 0;
                left: 0;
                width: 100%;
                border-radius: 8px 8px 0 0;
            }
        }

        .setting-panel h3{
            margin-top: 10px;
            margin-bottom: 10px;
            font-size: 14px;
            border-bottom: 1px solid #333;
            padding-bottom: 5px;
        }
        .color-palette {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            padding: 5px 0;
            border-bottom: 1px solid #333; 
            margin-bottom: 10px; 
        }
        .color-swatch {
            width: 20px;
            height: 20px;
            border: 1px solid #fff;
            cursor: pointer;
            transition: transform 0.1s;
        }
        .color-swatch:hover {
            transform: scale(1.1);
            z-index: 101;
            box-shadow: 0 0 5px white;
        }
        .download-button {
            width: 100%;
            padding: 10px;
            margin-top: 15px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.2s;
        }
        .download-button:hover {
            background-color: #0056b3;
        }
        .height-apply-btn {
            padding: 3px 8px; 
            background: #007bff; 
            color: white; 
            border: none; 
            border-radius: 3px; 
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .height-apply-btn:hover {
            background: #0056b3;
        }

        /* --- ì—´/í–‰ í¬ê¸° ì¡°ì ˆ (Resizer) ìŠ¤íƒ€ì¼ --- */
        .data-table td {
            position: relative;
        }

        /* ì—´ í¬ê¸° ì¡°ì ˆ ì»¤ì„œ ë³€ê²½ */
        .col-resizer {
            position: absolute;
            right: 0;
            top: 0;
            height: 100%;
            width: 5px;
            cursor: col-resize;
            z-index: 5;
        }

        /* í–‰ í¬ê¸° ì¡°ì ˆ ì»¤ì„œ ë³€ê²½ */
        .row-resizer {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 5px;
            cursor: row-resize;
            z-index: 5;
        }

        /* ğŸš€ [ì¶”ê°€] í¬ê¸° í‘œì‹œê¸° ìŠ¤íƒ€ì¼ */
        .resizer-display {
            position: fixed;
            background: rgba(255, 255, 255, 0.9);
            color: black;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            pointer-events: none;
            z-index: 200;
            opacity: 0;
            transition: opacity 0.1s;
        }
    </style>
</head>
<body class="bg-gray-900">

    <!-- ìº¡ì²˜ ëŒ€ìƒ ì˜ì—­ -->
    <div id="capture-area" class="wrap shadow-2xl">

        <!-- ìƒë‹¨ ì„œë¸Œ ë©”ë‰´ -->
        <div class="top-sub-menu">
            <div class="menu text-gray-300">ë…¸ë¸”ë ˆìŠ¤ ì„œë²„</div>
            <div class="menu text-gray-300">ê¸¸ë“œëª…: GM</div>
            <div class="menu text-gray-300">ì›”ë“œ: 14</div>
        </div>
        
        <!-- ì™¼ìª½ ë©”ë‰´ (ë°ì´í„° íƒ€ì…) -->
        <div class="left-menu">
            <div class="left-item active">ë ˆë²¨</div>
            <div class="left-item">ëˆ„ì </div>
            <div class="left-item">ìƒíƒœ</div>
            <div class="left-item">ì¥ë¹„</div>
            <div class="left-item">ìŠ¤í‚¬</div>
            <div class="left-item">í€˜ìŠ¤íŠ¸</div>
            <div class="left-item">ëª…ì„±</div>
        </div>

        <!-- ğŸ“Š ë°ì´í„° í…Œì´ë¸” -->
        <table class="data-table">
            <tbody>
                <!-- ìµœìƒë‹¨ ê³µì§€ í†µí•© ì…€ -->
                <tr class="top-notice-row">
                    <td colspan="5">
                        <span class="top-notice-mark">[í•„ë…]</span> ëª¨ë“  ë°ì´í„°ëŠ” ì‹¤ì‹œê°„ìœ¼ë¡œ ë³€ê²½ë  ìˆ˜ ìˆìœ¼ë©°, ì´ í‘œëŠ” í¸ì§‘ìš© í…œí”Œë¦¿ì…ë‹ˆë‹¤.
                    </td>
                </tr>

                <!-- ìƒë‹¨ ë°ì´í„° í—¤ë” -->
                <tr class="top-data-header">
                    <td>ë“±ê¸‰</td>
                    <td>ì´ë¦„</td>
                    <td>ê³µê²©ë ¥</td>
                    <td>ë°©ì–´ë ¥</td>
                    <td>íŠ¹ì„±</td>
                </tr>

                <!-- ìƒë‹¨ ë°ì´í„° í–‰ 1 -->
                <tr class="top-data-row">
                    <td contenteditable="true">SSR</td>
                    <td contenteditable="true">ì œê°ˆëŸ‰</td>
                    <td contenteditable="true">99,999</td>
                    <td contenteditable="true">10,000</td>
                    <td contenteditable="true">ì§€ëŠ¥í˜•</td>
                </tr>
                <!-- ìƒë‹¨ ë°ì´í„° í–‰ 2 -->
                <tr class="top-data-row">
                    <td contenteditable="true">SR</td>
                    <td contenteditable="true">ê´€ìš°</td>
                    <td contenteditable="true">85,000</td>
                    <td contenteditable="true">15,000</td>
                    <td contenteditable="true">ê·¼ë ¥í˜•</td>
                </tr>
                <!-- ìƒë‹¨ ë°ì´í„° í–‰ 3 -->
                <tr class="top-data-row">
                    <td contenteditable="true">R</td>
                    <td contenteditable="true">ì¥ë¹„</td>
                    <td contenteditable="true">70,000</td>
                    <td contenteditable="true">20,000</td>
                    <td contenteditable="true">ì²´ë ¥í˜•</td>
                </tr>

                <!-- ì¤‘ê°„ ê³µì§€ í†µí•© ì…€ -->
                <tr class="middle-notice-row">
                    <td colspan="5" contenteditable="true">
                        <span class="font-bold text-red-500">â€» ì¤‘ìš” ê³µì§€:</span> ì´ë²ˆ ì‹œì¦Œì˜ ìŠ¹ê¸‰ ì¡°ê±´ì´ ëŒ€í­ ìƒí–¥ë˜ì—ˆìŠµë‹ˆë‹¤. ìƒì„¸ ì¡°ê±´ì€ ê³µì§€ ê²Œì‹œíŒì„ í™•ì¸í•˜ì„¸ìš”.
                    </td>
                </tr>

                <!-- í•˜ë‹¨ ë°ì´í„° í—¤ë” -->
                <tr class="bottom-data-header">
                    <td>ì›”ê°„ ë­í‚¹</td>
                    <td>ì£¼ê°„ ë­í‚¹</td>
                    <td>ìµœëŒ€ ë”œëŸ‰</td>
                    <td>í‰ê·  ë”œëŸ‰</td>
                    <td>í‰ê°€</td>
                </tr>

                <!-- í•˜ë‹¨ ë°ì´í„° í–‰ 1 -->
                <tr class="bottom-data-row">
                    <td contenteditable="true">1ìœ„</td>
                    <td contenteditable="true">3ìœ„</td>
                    <td contenteditable="true" class="red-text">15,000M</td>
                    <td contenteditable="true">12,500M</td>
                    <td contenteditable="true">ë§¤ìš° ìš°ìˆ˜</td>
                </tr>
                <!-- í•˜ë‹¨ ë°ì´í„° í–‰ 2 -->
                <tr class="bottom-data-row">
                    <td contenteditable="true">5ìœ„</td>
                    <td contenteditable="true">8ìœ„</td>
                    <td contenteditable="true" class="red-text">9,000M</td>
                    <td contenteditable="true">7,500M</td>
                    <td contenteditable="true">ìš°ìˆ˜</td>
                </tr>
                <!-- í•˜ë‹¨ ë°ì´í„° í–‰ 3 -->
                <tr class="bottom-data-row">
                    <td contenteditable="true">12ìœ„</td>
                    <td contenteditable="true">20ìœ„</td>
                    <td contenteditable="true" class="red-text">6,000M</td>
                    <td contenteditable="true">5,500M</td>
                    <td contenteditable="true">ë³´í†µ</td>
                </tr>
            </tbody>
        </table>

    </div>
    <!-- ìº¡ì²˜ ëŒ€ìƒ ì˜ì—­ ë -->

    <!-- --- ì„¤ì • íŒ¨ë„ (UI) --- -->
    <div id="settingPanel" class="setting-panel">
        <h2 class="text-lg font-bold mb-3 text-center">ğŸ¨ ë°ì´í„° í¸ì§‘ ë„êµ¬</h2>

        <!-- ìƒ‰ìƒ ì¡°ì ˆ -->
        <h3>ìƒ‰ìƒ ì¡°ì ˆ (Text / BG)</h3>
        <div class="mb-3">
            <label class="mr-3">
                <input type="radio" name="colorTarget" value="text" checked> í…ìŠ¤íŠ¸
            </label>
            <label>
                <input type="radio" name="colorTarget" value="background"> ë°°ê²½
            </label>
        </div>
        <div class="color-palette">
            <!-- Swatches generated by JS -->
        </div>

        <!-- ê¸€ê¼´ í¬ê¸° ì¡°ì ˆ -->
        <h3>ê¸€ê¼´ í¬ê¸° (px)</h3>
        <div class="flex gap-2 items-center mb-4">
            <input type="number" id="fontSizeInput" value="14" min="8" max="40" 
                   class="w-16 p-1 text-sm text-gray-800 border rounded">
            <button id="applyFontSizeBtn" class="height-apply-btn">ì ìš©</button>
        </div>

        <!-- ê·¸ë£¹ë³„ ë†’ì´ ì¡°ì ˆ -->
        <h3>ê·¸ë£¹ë³„ í–‰ ë†’ì´ (px)</h3>
        <div class="space-y-2">
            <div class="flex justify-between items-center">
                <span>ìƒë‹¨ ë°ì´í„° (Header & Row):</span>
                <input type="number" id="topRowHeightInput" value="15" min="10" max="50" class="w-14 p-1 text-sm text-gray-800 border rounded">
                <button id="applyTopRowHeightBtn" class="height-apply-btn">ì ìš©</button>
            </div>
            <div class="flex justify-between items-center">
                <span>ì¤‘ê°„ ê³µì§€ (Notice):</span>
                <input type="number" id="middleRowHeightInput" value="25" min="10" max="50" class="w-14 p-1 text-sm text-gray-800 border rounded">
                <button id="applyMiddleRowHeightBtn" class="height-apply-btn">ì ìš©</button>
            </div>
            <div class="flex justify-between items-center">
                <span>í•˜ë‹¨ ë°ì´í„° (Header & Row):</span>
                <input type="number" id="bottomRowHeightInput" value="10" min="10" max="50" class="w-14 p-1 text-sm text-gray-800 border rounded">
                <button id="applyBottomRowHeightBtn" class="height-apply-btn">ì ìš©</button>
            </div>
        </div>

        <!-- ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ -->
        <button class="download-button shadow-lg">PNG ì´ë¯¸ì§€ë¡œ ë‹¤ìš´ë¡œë“œ</button>
        <p class="text-xs text-center mt-2 text-gray-400">Ctrl/Shift + Clickìœ¼ë¡œ ë‹¤ì¤‘ ì„ íƒ ê°€ëŠ¥</p>
    </div>
    <!-- --- ì„¤ì • íŒ¨ë„ ë --- -->

    <!-- í¬ê¸° ì¡°ì ˆ ë””ìŠ¤í”Œë ˆì´ -->
    <div id="resizerDisplay" class="resizer-display"></div>


    <script>
        // --- 1. ìƒ‰ìƒ íŒ”ë ˆíŠ¸ ë° í¸ì§‘ ê¸°ëŠ¥ ë³€ìˆ˜ ì„¤ì • ---

        const colors = [
            '#FF0000', '#FF4500', '#FFA500', '#FFFF00', '#ADFF2F', '#00FF00', '#3CB371', '#00FFFF',
            '#1E90FF', '#0000FF', '#8A2BE2', '#9400D3', '#FF00FF', '#FF69B4', '#FFC0CB', '#FFFFFF',
            '#CCCCCC', '#999999', '#666666', '#333333', '#000000', 
            '#800000', '#8B4513', '#D2B48C', '#F5DEB3', '#9ACD32', '#556B2F', '#008080', '#4682B4',
            '#4169E1', '#800080', '#DDA0DD', '#F08080', '#2F4F4F', '#A9A9A9', '#778899', '#C0C0C0', 
            '#228B22', '#CD5C5C', '#6A5ACD' 
        ];

        const colorPalette = document.querySelector('.color-palette');
        // dataTableì€ DOMContentLoaded ì´í›„ì— ë‹¤ì‹œ í• ë‹¹ë  ìˆ˜ ìˆìŒ
        let dataTable = document.querySelector('.data-table');
        const applyFontSizeBtn = document.getElementById('applyFontSizeBtn');
        const fontSizeInput = document.getElementById('fontSizeInput');

        // ğŸ“ ê·¸ë£¹ë³„ ë†’ì´ ì…ë ¥ í•„ë“œ ë³€ìˆ˜
        const topRowHeightInput = document.getElementById('topRowHeightInput');
        const middleRowHeightInput = document.getElementById('middleRowHeightInput');
        const bottomRowHeightInput = document.getElementById('bottomRowHeightInput');
        // ğŸ“ ê·¸ë£¹ë³„ ì ìš© ë²„íŠ¼ ë³€ìˆ˜
        const applyTopRowHeightBtn = document.getElementById('applyTopRowHeightBtn');
        const applyMiddleRowHeightBtn = document.getElementById('applyMiddleRowHeightBtn');
        const applyBottomRowHeightBtn = document.getElementById('applyBottomRowHeightBtn');

        const resizerDisplay = document.getElementById('resizerDisplay'); 


        // ğŸš€ LocalStorageì— í…Œì´ë¸” ë‚´ìš©ì„ ì €ì¥í•˜ëŠ” í•¨ìˆ˜
        function saveSettings() {
            const captureArea = document.getElementById('capture-area');
            if (captureArea) {
                // í…Œì´ë¸” ë‚´ìš© ì „ì²´ ì €ì¥
                localStorage.setItem('noblesseTableState', captureArea.innerHTML);
                
                // ğŸ“ ì„¸ ê°€ì§€ ë†’ì´ ì…ë ¥ê°’ ëª¨ë‘ ì €ì¥
                if (topRowHeightInput) localStorage.setItem('topRowHeightValue', topRowHeightInput.value);
                if (middleRowHeightInput) localStorage.setItem('middleRowHeightValue', middleRowHeightInput.value); 
                if (bottomRowHeightInput) localStorage.setItem('bottomRowHeightValue', bottomRowHeightInput.value);

                // ğŸ¨ í˜„ì¬ ì„ íƒëœ ìƒ‰ìƒ íƒ€ê²Ÿë„ ì €ì¥
                const colorTarget = document.querySelector('input[name="colorTarget"]:checked');
                if (colorTarget) localStorage.setItem('colorTarget', colorTarget.value);
                
                // ğŸ–±ï¸ í˜„ì¬ í™œì„±í™”ëœ ì™¼ìª½ ë©”ë‰´ë„ ì €ì¥ (í´ë˜ìŠ¤ë¥¼ ë¬¸ìì—´ë¡œ ì €ì¥)
                const activeMenuItem = document.querySelector('.left-item.active');
                if (activeMenuItem) {
                    const index = Array.from(document.querySelectorAll('.left-item')).indexOf(activeMenuItem);
                    localStorage.setItem('activeLeftMenuIndex', index.toString());
                }
            }
        }

        // ğŸš€ LocalStorageì—ì„œ ì €ì¥ëœ ë‚´ìš©ì„ ë¶ˆëŸ¬ì™€ ì ìš©í•˜ëŠ” í•¨ìˆ˜
        function loadSettings() {
            const savedState = localStorage.getItem('noblesseTableState');
            if (savedState) {
                const captureArea = document.getElementById('capture-area');
                if (captureArea) {
                    // ì €ì¥ëœ HTML ìƒíƒœë¡œ DOMì„ ë³€ê²½
                    captureArea.innerHTML = savedState;
                    
                    // dataTable ë³€ìˆ˜ë¥¼ ìƒˆë¡œ ë¡œë“œëœ DOM ìš”ì†Œë¡œ ì—…ë°ì´íŠ¸
                    dataTable = document.querySelector('.data-table');
                    
                    // ğŸ“ ì„¸ ê°€ì§€ ë†’ì´ ì…ë ¥ê°’ ë¡œë“œ
                    const savedTopHeight = localStorage.getItem('topRowHeightValue');
                    const savedMiddleHeight = localStorage.getItem('middleRowHeightValue');
                    const savedBottomHeight = localStorage.getItem('bottomRowHeightValue');

                    if (topRowHeightInput && savedTopHeight) {
                        topRowHeightInput.value = savedTopHeight;
                    }
                    if (middleRowHeightInput && savedMiddleHeight) {
                        middleRowHeightInput.value = savedMiddleHeight;
                    }
                    if (bottomRowHeightInput && savedBottomHeight) {
                        bottomRowHeightInput.value = savedBottomHeight;
                    }
                    
                    // ğŸ¨ ì €ì¥ëœ ìƒ‰ìƒ íƒ€ê²Ÿ ë¡œë“œ
                    const savedColorTarget = localStorage.getItem('colorTarget') || 'text';
                    const targetInput = document.querySelector(`input[name="colorTarget"][value="${savedColorTarget}"]`);
                    if(targetInput) targetInput.checked = true;
                    
                    // ğŸ–±ï¸ ê¸€ê¼´ í¬ê¸° ë¡œë“œëŠ” ì…€ ìƒì˜ ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ì„ ë”°ë¦„
                    const savedFontSize = document.querySelector('.data-table td')?.style.fontSize;
                    if (fontSizeInput && savedFontSize) {
                        fontSizeInput.value = parseInt(savedFontSize, 10) || 14;
                    }

                    console.log('ì´ì „ ì„¤ì •ì´ ì„±ê³µì ìœ¼ë¡œ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤. (Local Storage)');
                }
            }
        }

        // ğŸ¨ ìƒ‰ìƒ íƒ€ê²Ÿ ë³€ê²½ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        function initializeColorTargetControl() {
            document.querySelectorAll('input[name="colorTarget"]').forEach(radio => {
                radio.addEventListener('change', saveSettings); // ì„ íƒì´ ë³€ê²½ë  ë•Œë§ˆë‹¤ ì €ì¥
            });
        }

        // íŒ”ë ˆíŠ¸ ìƒì„± (ìƒ‰ìƒ ìŠ¤ì™€ì¹˜ í™”ë©´ì— í‘œì‹œ)
        function initializeColorPalette() {
            // íŒ”ë ˆíŠ¸ê°€ ì´ë¯¸ ìƒì„±ë˜ì–´ ìˆë‹¤ë©´ ì¤‘ë³µ ë°©ì§€
            if (colorPalette && colorPalette.children.length > 0) return;
            
            colors.forEach(color => {
                const swatch = document.createElement('div');
                swatch.className = 'color-swatch';
                swatch.style.backgroundColor = color;
                swatch.dataset.color = color;
                // í´ë¦­ ì‹œ ìƒ‰ìƒ ì ìš© ë° ì €ì¥
                swatch.addEventListener('click', () => {
                    applyColor(color);
                    saveSettings();
                }); 
                if (colorPalette) {
                    colorPalette.appendChild(swatch);
                }
            });
        }


        // ğŸ’¡ ì…€ í´ë¦­ ì´ë²¤íŠ¸: Shift í‚¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹¤ì¤‘ ì„ íƒ/í† ê¸€ ê¸°ëŠ¥ì„ í™œì„±í™”
        function initializeCellInteraction() {
            // ê¸°ì¡´ dataTable ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆê°€ ìˆë‹¤ë©´ ì œê±° í›„ ë‹¤ì‹œ ë“±ë¡ (loadSettings ë•Œë¬¸ì—)
            if (dataTable) {
                dataTable.removeEventListener('click', handleCellClick);
                dataTable.removeEventListener('input', saveSettings); 
            }
            
            // ë¡œë“œëœ ìƒˆë¡œìš´ DOMì—ì„œ dataTable ë³€ìˆ˜ ì¬í• ë‹¹
            dataTable = document.querySelector('.data-table');
            if (!dataTable) return;

            function handleCellClick(e) {
                if (e.target.tagName === 'TD') {
                    const cell = e.target;
                    
                    // í¬ê¸° ì¡°ì ˆ ì¤‘ì—ëŠ” ì…€ ì„ íƒì„ ë§‰ìŒ
                    if (dataTable.classList.contains('resizing')) return;

                    if (e.shiftKey) {
                        // Shift í‚¤ë¥¼ ëˆ„ë¥¸ ê²½ìš°: ê¸°ì¡´ ì„ íƒ ìƒíƒœë¥¼ ìœ ì§€í•˜ê³  í˜„ì¬ ì…€ì˜ ì„ íƒ ìƒíƒœë¥¼ í† ê¸€í•©ë‹ˆë‹¤.
                        cell.classList.toggle('selected');
                    } else {
                        // Shift í‚¤ë¥¼ ëˆ„ë¥´ì§€ ì•Šì€ ê²½ìš°: ê¸°ì¡´ ì„ íƒ ëª¨ë‘ í•´ì œ í›„ í˜„ì¬ ì…€ë§Œ ì„ íƒí•©ë‹ˆë‹¤.
                        document.querySelectorAll('.data-table td.selected').forEach(c => c.classList.remove('selected'));
                        cell.classList.add('selected');
                    }
                }
            }
            
            dataTable.addEventListener('click', handleCellClick);
            
            // ì…€ ë‚´ìš© í¸ì§‘ ì´ë²¤íŠ¸: ì…ë ¥ì´ ëë‚  ë•Œë§ˆë‹¤ ì €ì¥
            dataTable.addEventListener('input', (e) => {
                if (e.target.tagName === 'TD' && e.target.contentEditable === 'true') {
                    saveSettings();
                }
            });

        }

        // ğŸš€ ìƒ‰ìƒ ì ìš© í•¨ìˆ˜
        function applyColor(color) {
            const targetRadio = document.querySelector('input[name="colorTarget"]:checked');
            if (!targetRadio) return; 

            const target = targetRadio.value; 
            
            // DOMì—ì„œ '.selected' í´ë˜ìŠ¤ë¥¼ ê°€ì§„ ëª¨ë“  TDë¥¼ ë‹¤ì‹œ ì¡°íšŒ
            const cellsToApply = document.querySelectorAll('.data-table td.selected');

            cellsToApply.forEach(cell => {
                if (target === 'background') {
                    cell.style.backgroundColor = color;
                    // ë°°ê²½ìƒ‰ì´ ì ìš©ë  ê²½ìš°, í˜¸ë²„ ìŠ¤íƒ€ì¼ì„ ì˜¤ë²„ë¼ì´ë“œí•˜ê¸° ìœ„í•´ ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ì„ ì ìš©í•©ë‹ˆë‹¤.
                    cell.dataset.bgColor = color; 
                } else { // target === 'text'
                    cell.style.color = color;
                }
            });
        }


        // ğŸ“ ê¸€ê¼´ í¬ê¸° ì ìš© í•¨ìˆ˜
        function initializeFontSizeControl() {
            if (applyFontSizeBtn) {
                applyFontSizeBtn.removeEventListener('click', handleApplyFontSize);
                applyFontSizeBtn.addEventListener('click', handleApplyFontSize);
            }
        }

        function handleApplyFontSize() {
            if (!fontSizeInput.value) return;

            const newSize = fontSizeInput.value + 'px';
            document.querySelectorAll('.data-table td.selected').forEach(cell => {
                cell.style.fontSize = newSize;
                cell.style.lineHeight = '1.2'; 
            });
            saveSettings();
        }


        // --- 2. ğŸ–¼ï¸ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥ (ìˆ˜ì •ë¨: ìº¡ì²˜ ì „ì— ì„ íƒ ìƒíƒœ ì œê±°) ---
        function downloadImage(elementId, filename) {
            const element = document.getElementById(elementId);
            const settingPanel = document.getElementById('settingPanel');
            
            // 1. í˜„ì¬ ì„ íƒëœ ì…€ì„ ì €ì¥í•©ë‹ˆë‹¤.
            const selectedCells = document.querySelectorAll('.data-table td.selected');
            
            // 2. ìº¡ì²˜ ì „ì— ëª¨ë“  ì„ íƒëœ ì…€ì˜ í•˜ì´ë¼ì´íŠ¸(ë…¸ë€ìƒ‰ í…Œë‘ë¦¬)ë¥¼ ì œê±°í•©ë‹ˆë‹¤.
            selectedCells.forEach(cell => cell.classList.remove('selected'));
            
            // 3. ì„¤ì • íŒ¨ë„ ìˆ¨ê¸°ê¸°
            if (settingPanel) settingPanel.style.display = 'none';

            html2canvas(element, {
                scale: 2, 
                backgroundColor: null, 
                useCORS: true 
            }).then(canvas => {
                // 4. ìº¡ì²˜ ì™„ë£Œ í›„: ì„¤ì • íŒ¨ë„ ë‹¤ì‹œ í‘œì‹œ
                if (settingPanel) settingPanel.style.display = 'block';

                // 5. ì„ íƒ ìƒíƒœ ë³µì›
                selectedCells.forEach(cell => cell.classList.add('selected'));

                const dataURL = canvas.toDataURL('image/png');
                const link = document.createElement('a');
                link.href = dataURL;
                link.download = filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }).catch(error => {
                console.error('ì´ë¯¸ì§€ ìº¡ì²˜ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                // 6. ì˜¤ë¥˜ ë°œìƒ ì‹œì—ë„ ì„¤ì • íŒ¨ë„ ë‹¤ì‹œ í‘œì‹œ ë° ì„ íƒ ìƒíƒœ ë³µì›
                if (settingPanel) settingPanel.style.display = 'block'; 
                selectedCells.forEach(cell => cell.classList.add('selected'));
            });
        }


        // --- 3. ğŸ“ ì…€ í¬ê¸° ì¡°ì ˆ (Resizer) ë¡œì§ --- 
        let currentResizer = null; 
        let startX = 0;
        let startY = 0;
        let startWidth = 0;
        let startHeight = 0;
        let isRowResizer = false;

        // ì´ˆê¸°í™”: ê° ì…€ì— ë¦¬ì‚¬ì´ì € ì¶”ê°€
        function initializeResizers() {
            // DOMì´ ë³€ê²½ë˜ì—ˆìœ¼ë¯€ë¡œ, ê¸°ì¡´ ë¦¬ì‚¬ì´ì €ë¥¼ ì œê±°í•˜ê³  ìƒˆë¡œ ì¶”ê°€
            document.querySelectorAll('.col-resizer, .row-resizer').forEach(r => r.remove());

            // dataTableì„ ìƒˆë¡œ ë¡œë“œëœ DOMì—ì„œ ë‹¤ì‹œ ì°¸ì¡°
            dataTable = document.querySelector('.data-table');
            if (!dataTable) return;
            
            dataTable.querySelectorAll('tr:not(.middle-notice-row, .top-notice-row) td').forEach(td => {
                
                // ì—´ ë¦¬ì‚¬ì´ì € (td.nextElementSiblingì´ ìˆëŠ” ê²½ìš°ì—ë§Œ ì¶”ê°€)
                if (td.nextElementSibling) {
                    let colResizer = document.createElement('div');
                    colResizer.className = 'col-resizer';
                    td.appendChild(colResizer);
                    colResizer.addEventListener('mousedown', startResize);
                }

                // í–‰ ë¦¬ì‚¬ì´ì €
                const tr = td.parentElement;
                // top-notice-rowì²˜ëŸ¼ colspanì´ ìˆëŠ” ì…€ì—ë„ ë¦¬ì‚¬ì´ì €ê°€ ì¶”ê°€ë˜ëŠ” ê²ƒì„ ë°©ì§€
                if (td.getAttribute('colspan') === null) {
                    let rowResizer = document.createElement('div');
                    rowResizer.className = 'row-resizer';
                    td.appendChild(rowResizer);
                    rowResizer.addEventListener('mousedown', startResize);
                }
            });
        }

        // ë¦¬ì‚¬ì´ì¦ˆ ë¡œì§
        function startResize(e) {
            e.preventDefault(); 
            
            currentResizer = e.target;
            startX = e.clientX;
            startY = e.clientY;
            
            const cell = currentResizer.parentElement;
            
            if (currentResizer.classList.contains('col-resizer')) {
                isRowResizer = false;
                startWidth = cell.offsetWidth;
                dataTable.classList.add('resizing');
                if (resizerDisplay) resizerDisplay.style.opacity = 1;
            } else if (currentResizer.classList.contains('row-resizer')) {
                isRowResizer = true;
                startHeight = cell.offsetHeight;
                dataTable.classList.add('resizing');
                if (resizerDisplay) resizerDisplay.style.opacity = 1;
            }
            
            document.addEventListener('mousemove', handleResize);
            document.addEventListener('mouseup', stopResize);
        }

        function handleResize(e) {
            if (!currentResizer) return;

            const cell = currentResizer.parentElement;
            
            if (!isRowResizer) {
                const deltaX = e.clientX - startX;
                const newWidth = startWidth + deltaX;
                if (newWidth > 30) {
                    cell.style.width = newWidth + 'px';
                    cell.style.minWidth = newWidth + 'px';
                }
                
                if (resizerDisplay) {
                    resizerDisplay.textContent = `${Math.round(newWidth)} px (ê°€ë¡œ)`;
                    resizerDisplay.style.left = (e.clientX + 10) + 'px';
                    resizerDisplay.style.top = (e.clientY + 10) + 'px';
                }

            } else {
                const deltaY = e.clientY - startY;
                const newHeight = startHeight + deltaY;
                
                if (newHeight > 20) { 
                    const row = cell.parentElement;
                    row.style.height = newHeight + 'px'; 
                    row.querySelectorAll('td').forEach(td => {
                        td.style.height = newHeight + 'px';
                    });
                }
                
                if (resizerDisplay) {
                    resizerDisplay.textContent = `${Math.round(newHeight)} px (ì„¸ë¡œ)`;
                    resizerDisplay.style.left = (e.clientX + 10) + 'px';
                    resizerDisplay.style.top = (e.clientY + 10) + 'px';
                }
            }
        }

        function stopResize() {
            currentResizer = null;
            dataTable.classList.remove('resizing');
            
            if (resizerDisplay) resizerDisplay.style.opacity = 0; 
            
            document.removeEventListener('mousemove', handleResize);
            document.removeEventListener('mouseup', stopResize);
            
            saveSettings(); 
        }


        // --- 4. ğŸ–±ï¸ ì™¼ìª½ ë©”ë‰´ í•­ëª© ìƒ‰ìƒ í† ê¸€ ê¸°ëŠ¥ ---
        function initializeLeftMenu() {
            const leftMenuItems = document.querySelectorAll('.left-item');
            
            // ì €ì¥ëœ ì¸ë±ìŠ¤ë¥¼ ë¡œë“œí•˜ì—¬ í™œì„±í™”
            const savedIndex = localStorage.getItem('activeLeftMenuIndex');
            if (savedIndex !== null) {
                leftMenuItems.forEach(i => i.classList.remove('active'));
                if (leftMenuItems[parseInt(savedIndex)]) {
                    leftMenuItems[parseInt(savedIndex)].classList.add('active');
                }
            }
            
            leftMenuItems.forEach(item => {
                // ê¸°ì¡´ ë¦¬ìŠ¤ë„ˆ ì œê±° í›„ ë‹¤ì‹œ ë“±ë¡
                item.removeEventListener('click', handleLeftMenuClick);
                item.addEventListener('click', handleLeftMenuClick);
            });
            
            function handleLeftMenuClick() {
                leftMenuItems.forEach(i => i.classList.remove('active'));
                this.classList.add('active');
                saveSettings(); 
            }
        }


        // ğŸš€ íŠ¹ì • í–‰ ì„ íƒìì— ê°•ì œ ë†’ì´ ìŠ¤íƒ€ì¼ì„ ì ìš©í•˜ëŠ” í•¨ìˆ˜
        function applyRowHeight(selector, newHeight) {
            // ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ë¡œ ì ìš©
            document.querySelectorAll(selector).forEach(row => {
                row.style.height = newHeight;
                row.querySelectorAll('td').forEach(td => {
                    td.style.height = newHeight;
                    td.style.lineHeight = '1.2'; // ë†’ì´ ë³€ê²½ ì‹œ ë¼ì¸ ë†’ì´ ì¼ê´€ì„± ìœ ì§€
                });
            });
        }


        // --- 5. ğŸ“ ê·¸ë£¹ë³„ í–‰ ë†’ì´ ì¡°ì ˆ ê¸°ëŠ¥ ---
        function initializeRowHeightControl() {
            
            if (applyTopRowHeightBtn && topRowHeightInput) {
                applyTopRowHeightBtn.removeEventListener('click', handleApplyTopRowHeight);
                applyTopRowHeightBtn.addEventListener('click', handleApplyTopRowHeight);
                // ë¡œë“œ ì‹œì—ë„ ì´ˆê¸° ë†’ì´ ì ìš© (loadSettingsê°€ ê°’ì„ ì—…ë°ì´íŠ¸í–ˆì„ ê²½ìš°)
                applyRowHeight('.top-data-header, .top-data-row', topRowHeightInput.value + 'px');
            }

            if (applyMiddleRowHeightBtn && middleRowHeightInput) {
                applyMiddleRowHeightBtn.removeEventListener('click', handleApplyMiddleRowHeight);
                applyMiddleRowHeightBtn.addEventListener('click', handleApplyMiddleRowHeight);
                // ë¡œë“œ ì‹œì—ë„ ì´ˆê¸° ë†’ì´ ì ìš©
                applyRowHeight('.middle-notice-row', middleRowHeightInput.value + 'px');
            }

            if (applyBottomRowHeightBtn && bottomRowHeightInput) {
                applyBottomRowHeightBtn.removeEventListener('click', handleApplyBottomRowHeight);
                applyBottomRowHeightBtn.addEventListener('click', handleApplyBottomRowHeight);
                // ë¡œë“œ ì‹œì—ë„ ì´ˆê¸° ë†’ì´ ì ìš©
                applyRowHeight('.bottom-data-header, .bottom-data-row', bottomRowHeightInput.value + 'px');
            }
        }

        function handleApplyTopRowHeight() {
            const newHeightValue = topRowHeightInput.value;
            const newHeight = newHeightValue + 'px';
            applyRowHeight('.top-data-header, .top-data-row', newHeight);
            saveSettings();
        }

        function handleApplyMiddleRowHeight() {
            const newHeightValue = middleRowHeightInput.value;
            const newHeight = newHeightValue + 'px';
            // middle-title-rowê°€ HTMLì— ì—†ìœ¼ë¯€ë¡œ, middle-notice-rowì—ë§Œ ì ìš©
            applyRowHeight('.middle-notice-row', newHeight); 
            saveSettings();
        }

        function handleApplyBottomRowHeight() {
            const newHeightValue = bottomRowHeightInput.value;
            const newHeight = newHeightValue + 'px';
            applyRowHeight('.bottom-data-header, .bottom-data-row', newHeight);
            saveSettings();
        }


        // í˜ì´ì§€ ë¡œë“œ ì‹œ ê¸°ëŠ¥ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', () => {
            // 1. ìƒ‰ìƒ íŒ”ë ˆíŠ¸ ì´ˆê¸°í™” (DOM êµ¬ì¡°ì™€ ë¬´ê´€)
            initializeColorPalette(); 
            
            // 2. ì €ì¥ëœ ì„¤ì •ì„ ë¨¼ì € ë¡œë“œí•˜ì—¬ DOM êµ¬ì¡°ì™€ UI ì…ë ¥ê°’ ë³µì›
            loadSettings(); 
            
            // 3. ë¡œë“œëœ ìƒˆë¡œìš´ DOM êµ¬ì¡°ì— ë§ì¶° ëª¨ë“  ì´ë²¤íŠ¸ì™€ ë¦¬ì‚¬ì´ì €ë¥¼ ì´ˆê¸°í™”
            //     * ì¤‘ìš”: ì´ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰ë˜ì–´ì•¼ DOM ìš”ì†Œì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆê°€ ì •í™•íˆ ì—°ê²°ë©ë‹ˆë‹¤.
            initializeCellInteraction(); 
            initializeColorTargetControl(); 
            initializeFontSizeControl();
            initializeResizers(); 
            initializeLeftMenu(); 
            initializeRowHeightControl(); // UI ì…ë ¥ê°’ì„ ë°”íƒ•ìœ¼ë¡œ ìµœì¢… ë†’ì´ ì ìš©

            // ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ì— ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ í• ë‹¹
            const downloadButton = document.querySelector('.download-button');
            if (downloadButton) {
                // ê¸°ì¡´ ë¦¬ìŠ¤ë„ˆê°€ ìˆë‹¤ë©´ ì œê±°
                downloadButton.removeEventListener('click', downloadImage); 
                downloadButton.addEventListener('click', () => downloadImage('capture-area', 'noblesse_data_capture.png'));
            }
        }); 
    </script>
</body>
</html>
