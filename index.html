<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>노블레스 데이터 현황</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

    <link rel="stylesheet" href="style.css" />
</head>
<body>

<div class="setting-panel" id="settingPanel">
    <div style="color: #ffdd66; margin-top: 5px; margin-bottom: 10px; font-weight: bold;">
        ※ 사용법: 테이블 셀을 드래그하여 선택한 후, 아래 옵션을 클릭하면 적용됩니다.
    </div>

    <div class="color-target-control">
        <label><input type="radio" name="colorTarget" value="text" checked> 글자색 적용</label>
        <label><input type="radio" name="colorTarget" value="background"> 배경색 적용</label>
    </div>

    <div class="color-control">
        <h3>🎨 색상 팔레트 선택 (40색)</h3>
        <div class="color-palette" id="colorPaletteContainer"></div>
    </div>

    <div style="margin-top: 10px; padding-top: 15px; border-top: 1px solid #444;">
        <label for="fontSizeInput">글꼴 크기 (px): </label>
        <input type="number" id="fontSizeInput" min="8" max="48" value="14" style="width: 60px; margin-left: 5px; padding: 5px; color: black; border-radius: 3px; border: none;">
        <button id="applyFontSizeBtn" style="margin-left: 5px; padding: 5px 12px; background: #555; color: white; border: none; border-radius: 3px; cursor: pointer; transition: background 0.2s;">적용</button>
    </div>

    <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #444;">
        <h3>📐 그룹별 행 높이 (px)</h3>

        <div style="margin-bottom: 10px;">
            <label for="topRowHeightInput" style="display: block; margin-bottom: 5px;">상단 데이터 행 높이:</label>
            <input type="number" id="topRowHeightInput" min="10" max="200" value="36" style="width: 60px; padding: 5px; color: black; border-radius: 3px; border: none;">
            <button id="applyTopRowHeightBtn" class="height-apply-btn" data-target="top-data" style="margin-left: 5px; padding: 5px 12px; background: #555; color: white; border: none; border-radius: 3px; cursor: pointer;">적용</button>
        </div>

        <div style="margin-bottom: 10px;">
            <label for="middleNoticeRowHeightInput" style="display: block; margin-bottom: 5px;">중단 공지/제목 행 높이:</label>
            <input type="number" id="middleNoticeRowHeightInput" min="20" max="300" value="120" style="width: 60px; padding: 5px; color: black; border-radius: 3px; border: none;">
            <button id="applyMiddleNoticeRowHeightBtn" class="height-apply-btn" data-target="middle-notice" style="margin-left: 5px; padding: 5px 12px; background: #555; color: white; border: none; border-radius: 3px; cursor: pointer;">적용</button>
        </div>

        <div>
            <label for="bottomRowHeightInput" style="display: block; margin-bottom: 5px;">하단 데이터 행 높이:</label>
            <input type="number" id="bottomRowHeightInput" min="10" max="200" value="36" style="width: 60px; padding: 5px; color: black; border-radius: 3px; border: none;">
            <button id="applyBottomRowHeightBtn" class="height-apply-btn" data-target="bottom-data" style="margin-left: 5px; padding: 5px 12px; background: #555; color: white; border: none; border-radius: 3px; cursor: pointer;">적용</button>
        </div>
    </div>

    <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #444;">
        <h3>⚙️ 작업 도구</h3>
        <div style="display:flex; gap:8px; margin-bottom:8px;">
            <button id="autoSaveToggleBtn" class="small-btn">자동저장: OFF</button>
            <button id="saveNowBtn" class="small-btn">저장</button>
            <!-- 복사/붙여넣기/행추가/열추가/자동맞춤/관리자모드 버튼 제거 -->
        </div>
        <div style="display:flex; gap:8px;">
            <button id="downloadBtn" class="small-btn">이미지 다운로드</button>
        </div>
    </div>

    <button class="download-button" id="downloadFullBtn" style="margin-top:12px;">🖼️ 테이블 영역 이미지 다운로드 (PNG)</button>
</div>

<div class="wrap">
    <div id="selectionBox"></div>

    <div class="top-sub-menu">
        <div class="menu">블레스 전국 프레스티지 서비스</div>
        <div class="menu">VIP 회원 전용 통합 매니지먼트</div>
        <div class="menu">노블레스 회원 전용룸</div>
    </div>

    <div class="left-menu" id="leftMenu">
        <!-- 메뉴 항목들: data-target에 섹션 id 매핑 (super-top → top → middle → bottom) -->
        <button class="left-item" data-target="super-top">최상단</button>
        <button class="left-item" data-target="top-notice">상단</button>
        <button class="left-item" data-target="middle-notice">중단</button>
        <button class="left-item" data-target="bottom-data">하단</button>
    </div>

    <table class="data-table" id="capture-area" role="table">
        <tbody>
            <!-- 최상단: super-top -->
            <tr class="super-top-row" id="super-top" data-section="super-top" data-row-height="48">
                <td colspan="5" contenteditable="true">[최상단 영역] 공지/요약 - 여기에 최상단 문구를 입력하세요.</td>
            </tr>

            <!-- 상단 공지/헤더 -->
            <tr class="top-notice-row" id="top-notice" data-section="top" data-row-height="48">
                <td colspan="5" contenteditable="true">
                    <span class="top-notice-mark">DAMAGE!</span> 주의사항 4단계에서 일치 파트너십으로 통합된 유형만을 선택하여 공유 임무를 완료하며 함께 할때의 금일 결제 금액 후 공동 이익을 마감해야 합니다!
                </td>
            </tr>

            <tr class="top-data-header" data-section="top" data-row-height="40">
                <td contenteditable="true">회원ID</td>
                <td contenteditable="true">주문상태</td>
                <td contenteditable="true">인증상태</td>
                <td contenteditable="true">활성화 코드</td>
                <td contenteditable="true">승인된 암호 코드</td>
            </tr>

            <tr class="top-data-row" data-section="top" data-row-height="36">
                <td contenteditable="true">jkgov1203</td>
                <td contenteditable="true">발송 완료</td>
                <td contenteditable="true">승인 완료</td>
                <td contenteditable="true">NSACT2032897</td>
                <td contenteditable="true">NBS001001001</td>
            </tr>
            <tr class="top-data-row" data-section="top" data-row-height="36">
                <td contenteditable="true">sxcv4752</td>
                <td contenteditable="true">검수 대기</td>
                <td contenteditable="true">미승인</td>
                <td contenteditable="true">NSACT2032898</td>
                <td contenteditable="true">NBS001001002</td>
            </tr>
            <tr class="top-data-row" data-section="top" data-row-height="36">
                <td contenteditable="true">qwerty24689</td>
                <td contenteditable="true">진행 중</td>
                <td contenteditable="true">승인 완료</td>
                <td contenteditable="true">NSACT2032899</td>
                <td contenteditable="true">NBS001001003</td>
            </tr>
            <tr class="top-data-row" data-section="top" data-row-height="36">
                <td contenteditable="true">xsgf1575</td>
                <td contenteditable="true">발송 오류</td>
                <td contenteditable="true">비활성화</td>
                <td contenteditable="true">NSACT2032891</td>
                <td contenteditable="true">NBS001001004</td>
            </tr>

            <!-- 중단 공지 (중간 공지) -->
            <tr class="middle-notice-row" id="middle-notice" data-section="middle" data-row-height="120">
                <td colspan="5" contenteditable="true">
                    1. 위 공동구매 회원들이 클리어 데이터를 지시에 따라 진행하지 못하여 실패로 인해 회원가입 및 계정 비활성화되어 출금불가 <br>
                    2. 상호협력의 발전목적을 실천하기 위해 공식적으로 1~2회 연속 클리어수정을 특별히 승인하였으며, 수정주문은 만장일치로 합의되어야 합니다.<br>
                    3. 수정주문은 계좌와 계좌 이상 데이터 복구 후 출금 코드를 매니저 갱신을 완료해야 출금가능하며 데이터 완료 이전에는 현금 출금이 불가능합니다<br>
                    4.정산시스템에서 승인할 수 없어 출금할수 없게 되었습니다. 데이터 완료 이전에는 현금 출금이 불가능합니다.<br>
                    (예: 부활 포기한 계정의 경우 포인트출금 불가)
                </td>
            </tr>

            <!-- 하단 헤더 -->
            <tr class="bottom-data-header" data-section="bottom" id="bottom-data" data-row-height="40">
                <td class="w-20" contenteditable="true">주문유형</td>
                <td class="w-20" contenteditable="true">주문상세</td>
                <td contenteditable="true">투자금액 (원)</td>
                <td contenteditable="true">원금+수익금액</td>
                <td contenteditable="true">보장비율</td>
            </tr>

            <!-- 하단 데이터 -->
            <tr class="bottom-data-row" data-section="bottom" data-row-height="36">
                <td contenteditable="true">A</td>
                <td contenteditable="true">[2종택1]</td>
                <td contenteditable="true" style="color: #FF0000;">1,500,000</td>
                <td contenteditable="true">1,650,000</td>
                <td contenteditable="true" style="color: #FF0000;">0%</td>
            </tr>
            <tr class="bottom-data-row" data-section="bottom" data-row-height="36">
                <td contenteditable="true">B</td>
                <td contenteditable="true">[2종택1]</td>
                <td contenteditable="true">2,500,000</td>
                <td contenteditable="true">2,750,000</td>
                <td contenteditable="true">100%</td>
            </tr>
            <tr class="bottom-data-row" data-section="bottom" data-row-height="36">
                <td contenteditable="true">C</td>
                <td contenteditable="true">[2종택1]</td>
                <td contenteditable="true">0</td>
                <td contenteditable="true">0</td>
                <td contenteditable="true" style="color: #FF0000;">0%</td>
            </tr>
            <tr class="bottom-data-row" data-section="bottom" data-row-height="36">
                <td contenteditable="true">D</td>
                <td contenteditable="true">[2종택1]</td>
                <td contenteditable="true">0</td>
                <td contenteditable="true">0</td>
                <td contenteditable="true" style="color: #FF0000;">0%</td>
            </tr>

        </tbody>
    </table>
</div>

<div class="resizer-display" id="resizerDisplay"></div>

<script type="module" src="app.js"></script>
</body>
</html>
