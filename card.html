<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>VIP 카드 편집</title>
  <link rel="stylesheet" href="style.css">
</head>

<body class="card-page">

<div class="card-editor-wrap">

  <!-- 카드 캔버스 -->
  <canvas id="cardCanvas" width="1024" height="640"></canvas>

  <!-- 툴 패널 -->
  <div class="panel">
    <h2>카드 텍스트 편집</h2>

    <label>표시 텍스트</label>
    <input id="textInput" type="text" value="노블레스">

    <label>폰트 크기</label>
    <input id="fontSize" type="number" value="48">

    <label>폰트 색상</label>
    <input id="fontColor" type="color" value="#ffffff">

    <button id="saveBtn">이미지 저장</button>
  </div>
</div>

<script>
// VIP 번호 가져오기
const url = new URL(location.href);
const vip = url.searchParams.get("vip") || "1";

// 캔버스
const canvas = document.getElementById("cardCanvas");
const ctx = canvas.getContext("2d");

// VIP 카드 이미지 경로 (루트 기준)
const cardImg = new Image();
cardImg.src = `img/vip${vip}.png`;

cardImg.onload = render;

// UI 요소
const textInput = document.getElementById("textInput");
const fontSize = document.getElementById("fontSize");
const fontColor = document.getElementById("fontColor");

function render() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.drawImage(cardImg, 0, 0, canvas.width, canvas.height);

  ctx.font = `${fontSize.value}px NanumGothic`;
  ctx.fillStyle = fontColor.value;
  ctx.textAlign = "center";

  ctx.fillText(textInput.value, canvas.width / 2, canvas.height - 80);
}

textInput.oninput = render;
fontSize.oninput = render;
fontColor.oninput = render;

// 이미지 저장
document.getElementById("saveBtn").onclick = () => {
  const a = document.createElement("a");
  a.href = canvas.toDataURL("image/png");
  a.download = `vip${vip}_card.png`;
  a.click();
};
</script>

</body>
</html>
